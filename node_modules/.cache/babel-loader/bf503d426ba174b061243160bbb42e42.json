{"ast":null,"code":"var _jsxFileName = \"/Users/kayode/Desktop/React/playground/mini-blog/src/components/Discussions.jsx\",\n    _s = $RefreshSig$();\n\nimport LikedComment from './LikedComment';\nimport LikedReply from './LikedReply';\nimport { useState, useEffect } from 'react';\nimport AddComment from './AddComment';\nimport CommentGoBack from './CommentGoBack';\nimport { useParams } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Discussions = () => {\n  _s();\n\n  const {\n    id\n  } = useParams();\n  const [error, setError] = useState(false);\n  const [discussions, setDiscussions] = useState(null);\n  useEffect(() => {\n    const abortCont = new AbortController();\n    fetch(`http://192.168.1.98:5000/blogs/${id}`, {\n      signal: abortCont.signal\n    }).then(res => {\n      if (!res.ok) {\n        throw new Error('Could not get data from the database');\n      }\n\n      return res.json();\n    }).then(data => {\n      setDiscussions(data);\n    }).catch(err => {\n      if (err.name === 'AbortError') {// empty if statement\n      } else {\n        setError(true);\n      }\n    });\n    return () => abortCont.abort();\n  }, [id, discussions.liked]); //Like a comment\n\n  const likeComment = did => {\n    const url = `http://192.168.1.98:5000/blogs/${id}`; // setDiscussions({\n    // \t...discussions,\n    // \tdiscussion: discussions.discussion.map((discussion) => {\n    // \t\tif (discussion.id === did) {\n    // \t\t\treturn { ...discussion, liked: !discussion.liked };\n    // \t\t} else {\n    // \t\t\treturn discussion;\n    // \t\t}\n    // \t}),\n    // });\n\n    fetch(url, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({ ...discussions,\n        discussion: discussions.discussion.map(discussion => {\n          if (discussion.id === did) {\n            return { ...discussion,\n              liked: !discussion.liked\n            };\n          } else {\n            return discussion;\n          }\n        })\n      })\n    });\n  }; //Like a reply\n\n\n  const likeReply = (xid, did) => {\n    const url = `http://192.168.1.98:5000/blogs${id}`;\n    setDiscussions({ //get the current discussion\n      ...discussions,\n      //loop through to update\n      discussion: discussions.discussion.map(discussion => {\n        //check if the discussion id matches the one you clicked\n        if (discussion.id === xid) {\n          //if yes, return the new discussion\n          return { //get the current replies\n            ...discussion,\n            //loop through the current replies\n            replies: discussion.replies.map(reply => {\n              //check if the reply id matches the one you clicked\n              if (reply.id === did) {\n                //finally update the liked status\n                return { ...reply,\n                  liked: !reply.liked\n                };\n              } else {\n                //if no, return the old reply\n                return reply;\n              }\n            })\n          };\n        } else {\n          //if no, return the old discussion\n          return discussion;\n        }\n      })\n    });\n    fetch(url, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({ ...discussions,\n        //loop through to update\n        discussion: discussions.discussion.map(discussion => {\n          //check if the discussion id matches the one you clicked\n          if (discussion.id === xid) {\n            //if yes, return the new discussion\n            return { //get the current replies\n              ...discussion,\n              //loop through the current replies\n              replies: discussion.replies.map(reply => {\n                //check if the reply id matches the one you clicked\n                if (reply.id === did) {\n                  //finally update the liked status\n                  return { ...reply,\n                    liked: !reply.liked\n                  };\n                } else {\n                  //if no, return the old reply\n                  return reply;\n                }\n              })\n            };\n          } else {\n            //if no, return the old discussion\n            return discussion;\n          }\n        })\n      })\n    });\n  };\n\n  const toggleComments = did => {\n    setDiscussions({ ...discussions,\n      discussion: discussions.discussion.map(discussion => {\n        if (discussion.id === did) {\n          return { ...discussion,\n            isOpen: !discussion.isOpen\n          };\n        } else {\n          return discussion;\n        }\n      })\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"commentError\",\n      children: \"Cannot retrieve comments \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 14\n    }, this), discussions && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(CommentGoBack, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"commentSection\",\n        children: discussions.discussion.map((discussion, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"comment\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              onDoubleClick: () => likeComment(discussion.id),\n              className: \"commentImg\",\n              src: discussion.thumbnail,\n              alt: \"userImg\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 10\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"commentBody\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                onDoubleClick: () => likeComment(discussion.id),\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: discussion.user\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 168,\n                  columnNumber: 12\n                }, this), \" \", discussion.comment]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 11\n              }, this), discussion.replies.length === 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: () => toggleComments(discussion.id),\n                className: \"toggleComments\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: discussion.isOpen ? `Hide ${discussion.replies.length} reply` : `Show ${discussion.replies.length} reply`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 176,\n                  columnNumber: 13\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 172,\n                columnNumber: 12\n              }, this), discussion.replies.length >= 2 && /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: () => toggleComments(discussion.id),\n                className: \"toggleComments\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: discussion.isOpen ? `Hide ${discussion.replies.length} replies` : `Show ${discussion.replies.length} replies`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 189,\n                  columnNumber: 13\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 185,\n                columnNumber: 12\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 10\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"commentEmoji\",\n              children: /*#__PURE__*/_jsxDEV(LikedComment, {\n                liked: discussion.liked,\n                onClick: () => likeComment(discussion.id)\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 11\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 10\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 9\n          }, this), discussion.isOpen ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"replies\",\n            children: discussion.replies.map((reply, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"reply\",\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  onDoubleClick: () => likeReply(discussion.id, reply.id),\n                  className: \"replyImg\",\n                  src: reply.thumbnail,\n                  alt: \"userImg\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 211,\n                  columnNumber: 14\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"replyBody\",\n                  children: /*#__PURE__*/_jsxDEV(\"p\", {\n                    onDoubleClick: () => likeReply(discussion.id, reply.id),\n                    children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                      children: reply.replier\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 219,\n                      columnNumber: 16\n                    }, this), \" \", reply.reply]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 218,\n                    columnNumber: 15\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 217,\n                  columnNumber: 14\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"replyEmoji\",\n                  children: /*#__PURE__*/_jsxDEV(LikedReply, {\n                    liked: reply.liked,\n                    onClick: () => likeReply(discussion.id, reply.id)\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 223,\n                    columnNumber: 15\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 222,\n                  columnNumber: 14\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 13\n              }, this)\n            }, reply.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 12\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 10\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"replies\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 234,\n            columnNumber: 10\n          }, this)]\n        }, discussion.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 8\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(AddComment, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true);\n};\n\n_s(Discussions, \"AgwIfXF5cxwe2ECNFesioaV9ZGc=\", false, function () {\n  return [useParams];\n});\n\n_c = Discussions;\nexport default Discussions;\n\nvar _c;\n\n$RefreshReg$(_c, \"Discussions\");","map":{"version":3,"sources":["/Users/kayode/Desktop/React/playground/mini-blog/src/components/Discussions.jsx"],"names":["LikedComment","LikedReply","useState","useEffect","AddComment","CommentGoBack","useParams","Discussions","id","error","setError","discussions","setDiscussions","abortCont","AbortController","fetch","signal","then","res","ok","Error","json","data","catch","err","name","abort","liked","likeComment","did","url","method","headers","body","JSON","stringify","discussion","map","likeReply","xid","replies","reply","toggleComments","isOpen","index","thumbnail","user","comment","length","replier"],"mappings":"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","sourcesContent":["import LikedComment from './LikedComment';\nimport LikedReply from './LikedReply';\nimport { useState, useEffect } from 'react';\nimport AddComment from './AddComment';\nimport CommentGoBack from './CommentGoBack';\nimport { useParams } from 'react-router-dom';\n\nconst Discussions = () => {\n\tconst { id } = useParams();\n\tconst [error, setError] = useState(false);\n\tconst [discussions, setDiscussions] = useState(null);\n\n\tuseEffect(() => {\n\t\tconst abortCont = new AbortController();\n\n\t\tfetch(`http://192.168.1.98:5000/blogs/${id}`, { signal: abortCont.signal })\n\t\t\t.then((res) => {\n\t\t\t\tif (!res.ok) {\n\t\t\t\t\tthrow new Error('Could not get data from the database');\n\t\t\t\t}\n\t\t\t\treturn res.json();\n\t\t\t})\n\t\t\t.then((data) => {\n\t\t\t\tsetDiscussions(data);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tif (err.name === 'AbortError') {\n\t\t\t\t\t// empty if statement\n\t\t\t\t} else {\n\t\t\t\t\tsetError(true);\n\t\t\t\t}\n\t\t\t});\n\n\t\treturn () => abortCont.abort();\n\t}, [id, discussions.liked]);\n\n\t//Like a comment\n\tconst likeComment = (did) => {\n\t\tconst url = `http://192.168.1.98:5000/blogs/${id}`;\n\t\t// setDiscussions({\n\t\t// \t...discussions,\n\t\t// \tdiscussion: discussions.discussion.map((discussion) => {\n\t\t// \t\tif (discussion.id === did) {\n\t\t// \t\t\treturn { ...discussion, liked: !discussion.liked };\n\t\t// \t\t} else {\n\t\t// \t\t\treturn discussion;\n\t\t// \t\t}\n\t\t// \t}),\n\t\t// });\n\t\tfetch(url, {\n\t\t\tmethod: 'PATCH',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t\tbody: JSON.stringify({\n\t\t\t\t...discussions,\n\t\t\t\tdiscussion: discussions.discussion.map((discussion) => {\n\t\t\t\t\tif (discussion.id === did) {\n\t\t\t\t\t\treturn { ...discussion, liked: !discussion.liked };\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn discussion;\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t}),\n\t\t});\n\t};\n\n\t//Like a reply\n\tconst likeReply = (xid, did) => {\n\t\tconst url = `http://192.168.1.98:5000/blogs${id}`;\n\t\tsetDiscussions({\n\t\t\t//get the current discussion\n\t\t\t...discussions,\n\t\t\t//loop through to update\n\t\t\tdiscussion: discussions.discussion.map((discussion) => {\n\t\t\t\t//check if the discussion id matches the one you clicked\n\t\t\t\tif (discussion.id === xid) {\n\t\t\t\t\t//if yes, return the new discussion\n\t\t\t\t\treturn {\n\t\t\t\t\t\t//get the current replies\n\t\t\t\t\t\t...discussion,\n\t\t\t\t\t\t//loop through the current replies\n\t\t\t\t\t\treplies: discussion.replies.map((reply) => {\n\t\t\t\t\t\t\t//check if the reply id matches the one you clicked\n\t\t\t\t\t\t\tif (reply.id === did) {\n\t\t\t\t\t\t\t\t//finally update the liked status\n\t\t\t\t\t\t\t\treturn { ...reply, liked: !reply.liked };\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//if no, return the old reply\n\t\t\t\t\t\t\t\treturn reply;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\t//if no, return the old discussion\n\t\t\t\t\treturn discussion;\n\t\t\t\t}\n\t\t\t}),\n\t\t});\n\t\tfetch(url, {\n\t\t\tmethod: 'PATCH',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t\tbody: JSON.stringify({\n\t\t\t\t...discussions,\n\t\t\t\t//loop through to update\n\t\t\t\tdiscussion: discussions.discussion.map((discussion) => {\n\t\t\t\t\t//check if the discussion id matches the one you clicked\n\t\t\t\t\tif (discussion.id === xid) {\n\t\t\t\t\t\t//if yes, return the new discussion\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t//get the current replies\n\t\t\t\t\t\t\t...discussion,\n\t\t\t\t\t\t\t//loop through the current replies\n\t\t\t\t\t\t\treplies: discussion.replies.map((reply) => {\n\t\t\t\t\t\t\t\t//check if the reply id matches the one you clicked\n\t\t\t\t\t\t\t\tif (reply.id === did) {\n\t\t\t\t\t\t\t\t\t//finally update the liked status\n\t\t\t\t\t\t\t\t\treturn { ...reply, liked: !reply.liked };\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t//if no, return the old reply\n\t\t\t\t\t\t\t\t\treturn reply;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//if no, return the old discussion\n\t\t\t\t\t\treturn discussion;\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t}),\n\t\t});\n\t};\n\n\tconst toggleComments = (did) => {\n\t\tsetDiscussions({\n\t\t\t...discussions,\n\t\t\tdiscussion: discussions.discussion.map((discussion) => {\n\t\t\t\tif (discussion.id === did) {\n\t\t\t\t\treturn { ...discussion, isOpen: !discussion.isOpen };\n\t\t\t\t} else {\n\t\t\t\t\treturn discussion;\n\t\t\t\t}\n\t\t\t}),\n\t\t});\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t{error && <div className=\"commentError\">Cannot retrieve comments </div>}\n\t\t\t{discussions && (\n\t\t\t\t<>\n\t\t\t\t\t<CommentGoBack />\n\n\t\t\t\t\t<div className=\"commentSection\">\n\t\t\t\t\t\t{discussions.discussion.map((discussion, index) => (\n\t\t\t\t\t\t\t<div key={discussion.id}>\n\t\t\t\t\t\t\t\t<div className=\"comment\">\n\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\tonDoubleClick={() => likeComment(discussion.id)}\n\t\t\t\t\t\t\t\t\t\tclassName=\"commentImg\"\n\t\t\t\t\t\t\t\t\t\tsrc={discussion.thumbnail}\n\t\t\t\t\t\t\t\t\t\talt=\"userImg\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div className=\"commentBody\">\n\t\t\t\t\t\t\t\t\t\t<p onDoubleClick={() => likeComment(discussion.id)}>\n\t\t\t\t\t\t\t\t\t\t\t<span>{discussion.user}</span> {discussion.comment}\n\t\t\t\t\t\t\t\t\t\t</p>\n\n\t\t\t\t\t\t\t\t\t\t{discussion.replies.length === 1 && (\n\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => toggleComments(discussion.id)}\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"toggleComments\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{discussion.isOpen\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? `Hide ${discussion.replies.length} reply`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: `Show ${discussion.replies.length} reply`}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t{discussion.replies.length >= 2 && (\n\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => toggleComments(discussion.id)}\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"toggleComments\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{discussion.isOpen\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? `Hide ${discussion.replies.length} replies`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: `Show ${discussion.replies.length} replies`}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"commentEmoji\">\n\t\t\t\t\t\t\t\t\t\t<LikedComment\n\t\t\t\t\t\t\t\t\t\t\tliked={discussion.liked}\n\t\t\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => likeComment(discussion.id)}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t{discussion.isOpen ? (\n\t\t\t\t\t\t\t\t\t<div className=\"replies\">\n\t\t\t\t\t\t\t\t\t\t{discussion.replies.map((reply, index) => (\n\t\t\t\t\t\t\t\t\t\t\t<div key={reply.id}>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"reply\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonDoubleClick={() => likeReply(discussion.id, reply.id)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"replyImg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={reply.thumbnail}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"userImg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"replyBody\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p onDoubleClick={() => likeReply(discussion.id, reply.id)}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{reply.replier}</span> {reply.reply}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"replyEmoji\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<LikedReply\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tliked={reply.liked}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => likeReply(discussion.id, reply.id)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<div className=\"replies\"></div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<AddComment />\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default Discussions;\n"]},"metadata":{},"sourceType":"module"}